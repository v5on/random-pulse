name: Random Pulse Generator

on:
  schedule:
    - cron: "*/10 * * * *"   # ржкрзНрж░рждрж┐ рззрзж ржорж┐ржирж┐ржЯрзЗ рж░рж╛ржи рж╣ржмрзЗ
  workflow_dispatch:         # ржорзНржпрж╛ржирзБрзЯрж╛рж▓рж┐ ржЪрж╛рж▓рж╛ржирзЛрж░ рж╕рзБржмрж┐ржзрж╛

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
      - name: рж░рж┐ржкрзЛ ржХрзНрж▓рзЛржи
        uses: actions/checkout@v3

      - name: Python рж╕рзЗржЯржЖржк
        uses: actions/setup-python@v4
        with:
          python-version: "3.11"

      - name: ржкрзНрж░рзЯрзЛржЬржирзАрзЯ ржкрзНржпрж╛ржХрзЗржЬ ржЗржирж╕рзНржЯрж▓
        run: pip install pytz

      - name: рж╕рзНржХрзНрж░рж┐ржкрзНржЯ рж░рж╛ржи ржХрж░рж╛
        run: python pulse.py

      - name: ржЧрж┐ржЯ ржХржиржлрж┐ржЧрж╛рж░ ржХрж░рж╛
        run: |
          git config user.name "GitHub Actions"
          git config user.email "actions@github.com"

      - name: ржкрж░рж┐ржмрж░рзНрждржи ржпрзЛржЧ ржУ ржкрзБрж╢
        run: |
          git add data/latest.json
          git commit -m "ЁЯФв Update random number" || echo "ржХрзЛржи ржкрж░рж┐ржмрж░рзНрждржи ржирзЗржЗ"
          git push
        env:
          GIT_TOKEN: ${{ secrets.GH_PAT }}
          GIT_AUTHOR_NAME: GitHub Actions
          GIT_AUTHOR_EMAIL: actions@github.com
          GIT_COMMITTER_NAME: GitHub Actions
          GIT_COMMITTER_EMAIL: actions@github.com
